@using ProfileManager.ViewModels;
@using ProfileManager.Common.Helpers;
@using ProfileManager.Common.Paginate;
@using Newtonsoft.Json;

@{
    ViewData["Title"] = "Home Page";
}

@model Paginate<ProfileViewModel>

@inject IConfiguration Configuration
@{
    var pageSize = Configuration["Pagnation:PageSize"];
}

<section class="h-100 gradient-custom-2">
    <div class="container h-100">
        <div class="row d-flex justify-content-center">

            <div class="col col-lg-3 col-xl-4">
                <section class="my-2" style="p-2 border-radius: .5rem .5rem 0 0;">
                    <div class="row d-flex justify-content-center">
                        <div class="col-12 col-md-12">
                            <div class="card" style="border-radius: 15px;">
                                <div class="card-body p-3">
                                  <h3>Filter</h3>
                                  <hr />


                                    <div class="mb-3">
                                        <label for="exampleFormControlInput1" class="form-label">Gender </label>
                                        
                                            <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                                                <input type="radio" class="btn-check" name="btnGender" id="btnradio1" autocomplete="off" value="1" checked>
                                                <label class="btn btn-outline-primary" for="btnradio1">Male</label>

                                                <input type="radio" class="btn-check" name="btnGender" id="btnradio3" autocomplete="off" value="2">
                                                <label class="btn btn-outline-primary" for="btnradio3">Female</label>
                                            </div>
                                                                   
                                    </div>
                                    <div class="mb-3">
                                        <label for="exampleFormControlInput1" class="form-label">District</label>
                                     
                                            <select class="form-select" aria-label="Select District">
                                                <option selected>Open this select menu</option>
                                                <option value="1">One</option>
                                                <option value="2">Two</option>
                                                <option value="3">Three</option>
                                            </select>
                   
                                    </div>
                                    <div class="mb-3">
                                        <button id="btnFilter" class="btn btn-primary">Filter</button>


                                    </div>
                              

                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <div class="col col-lg-9 col-xl-8">
                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        @foreach (ProfileViewModel item in Model.Data)
                        {
                            <section class="my-2" style="p-2 border-radius: .5rem .5rem 0 0;">
                                <div class="row d-flex justify-content-center">
                                    <div class="col-12 col-md-12">
                                        <div class="card" style="border-radius: 15px;">
                                            <div class="card-body p-3">
                                                <div class="d-flex">
                                                    <div class="flex-shrink-1">
                                                        @if (item.Gender == ProfileManager.Common.Enums.GenderEnum.Female)
                                                        {
                                                            <img src="~/images/woman.png"
                                                                 alt="Generic placeholder image" class="img-fluid" style="width: 180px; border-radius: 10px;">
                                                        }
                                                        else
                                                        {
                                                            <img src="~/images/man.png"
                                                                 alt="Generic placeholder image" class="img-fluid" style="width: 180px; border-radius: 10px;">
                                                        }
                                                    </div>
                                                    <div class="flex-grow-1 ms-3">
                                                        <h5 class="mb-1">@item.FirstName @item.LastName</h5>
                                                        <p class="mb-2 pb-1">@EnumExtensions.GetDisplayName(item.Job)</p>
                                                        <hr />

                                                        <div class="d-flex flex-wrap justify-content-start rounded-3 p-2 mb-2 bg-body-tertiary">
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Gender</p>
                                                                <p class="small mb-0 w-100">@EnumExtensions.GetDisplayName(item.Gender)</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Civil Status</p>
                                                                <p class="small mb-0 w-100">@EnumExtensions.GetDisplayName(item.CivilStatus)</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Age</p>
                                                                <p class="small mb-0 w-100">@item.Age</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Race</p>
                                                                <p class="small mb-0 w-100">@EnumExtensions.GetDisplayName(item.Race)</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Religion</p>
                                                                <p class="small mb-0 w-100">@EnumExtensions.GetDisplayName(item.Religion)</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Cast</p>
                                                                <p class="small mb-0 w-100">@EnumExtensions.GetDisplayName(item.Cast)</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">City</p>
                                                                <p class="small mb-0 w-100">@EnumExtensions.GetDisplayName(item.City)</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Country</p>
                                                                <p class="small mb-0 w-100">@EnumExtensions.GetDisplayName(item.Country)</p>
                                                            </div>
                                                            <div class="px-1 pb-2">
                                                                <p class="small text-muted mb-1">Published</p>
                                                                <p class="small mb-0 w-100">@TimeCal.AsTimeAgo(item.CreatedOn)</p>
                                                            </div>

                                                        </div>


                                                        <div class="col-4 col-xs-12 d-flex pt-1">
                                                            <a href="@Url.Action("Details", "Home",new{id=item.Id})" data-mdb-button-init data-mdb-ripple-init class="btn btn-sm btn-outline-primary me-1 flex-grow-1">Details</a>
                                                            <a href="#" data-mdb-button-init data-mdb-ripple-init class="btn btn-sm btn-primary flex-grow-1">Connect</a>


                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                        }
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>


<nav aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
        <li class="page-item">
            <a class="page-link" href="@Url.Action("Index", "Home" , new { PageSize=pageSize, PageNumber=1 })">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>

        @if (Model.CurrentPage > 1)
        {
            <li class="page-item">
                <a class="page-link" href="@Url.Action("Index", "Home" , new { PageSize=pageSize, PageNumber=Model.CurrentPage - 1 })">
                    <span aria-hidden="true">&lsaquo;</span>
                </a>
            </li>
        }

        @for (int i = 1; i <= Model.TotalPages; i++)
        {
            @if (i == Model.CurrentPage)
            {
                <li class="page-item active">
                    <a class="page-link" href="@Url.Action("Index", "Home" , new { PageSize=pageSize, PageNumber=i })">@i.ToString()</a>
                </li>
            }else
            {
                <li class="page-item">
                    <a class="page-link" href="@Url.Action("Index", "Home" , new { PageSize=pageSize, PageNumber=i })">@i.ToString()</a>
                </li>
            }  
        }

        @if (Model.CurrentPage < Model.TotalPages)
        {
            <li class="page-item">
                <a class="page-link" href="@Url.Action("Index", "Home" , new { PageSize=pageSize, PageNumber=Model.CurrentPage + 1 })">
                    <span aria-hidden="true">&rsaquo;</span>
                </a>
            </li>
        }
   

        <li class="page-item">         
            <a class="page-link" href="@Url.Action("Index", "Home" , new { PageSize=pageSize, PageNumber=Model.TotalPages })">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        
    </ul>
</nav>




<section class="h-100 gradient-custom-2">
    <div class="container h-100">
        <div class="row d-flex justify-content-center">

            <div class="col col-lg-9 col-xl-8">
                <div class="row">
                    <div class="col-md-12 col-sm-12">

                        <div id="filter-list"></div>

                    </div>
                </div>
            </div>

        </div>
    </div>
</section>

<div id="paginage"></div>







@section Scripts{
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#btnFilter").click(function () {
                var gender = $('input[name="btnGender"]:checked').val();
                console.log('ss', gender);

                filter();
               
            });
        });


        function filter(){

            var filter = {
                page: {
                    pagenumber: 1, pagesize: 2
                },
                
                gender: 2
               
               
            }

            axios.post('/Home/Filter', filter)
                .then(function (response) {
                    console.log(response);
                    bind(response);
                    
                })
                .catch(function (error) {
                    console.log(error);
                });

            
        }



        function bind(response){           
            var data = '';
            $.each(response.data.data, function (key, value) {
                var dataRow = 
                    '<section class="my-2" style="p-2 border-radius: .5rem .5rem 0 0;">'+
                    '<div class="row d-flex justify-content-center">'+
                    '<div class="col-12 col-md-12">'+
                    '<div class="card" style="border-radius: 15px;">'+
                    '<div class="card-body p-3">'+
                    '<div class="d-flex">'+
                    '<div class="flex-shrink-1">'+
                    (value.enumNames.gender == 'Male' ? 
                        '<img src="/images/man.png" alt = "Generic placeholder image" class="img-fluid" style = "width: 180px; border-radius: 10px;" >':
                        '<img src="/images/woman.png" alt = "Generic placeholder image" class="img-fluid" style = "width: 180px; border-radius: 10px;" >'
                    )+
                    '</div>'+
                
                    '<div class="flex-grow-1 ms-3">'+
                    '<h5 class="mb-1">'+value.firstName+' '+value.lastName+'</h5>'+
                    '<p class="mb-2 pb-1">' + value.enumNames.job + '</p>'+
                    '<hr />'+

                    '<div class="d-flex flex-wrap justify-content-start rounded-3 p-2 mb-2 bg-body-tertiary">'+
                    '<div class="px-1 pb-2">'+
                    '<p class="small text-muted mb-1">Gender</p>'+
                    '<p class="small mb-0 w-100">' + value.enumNames.gender + '</p>' +
                    '</div>'+
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.enumNames.civilStatus + '</p>' +
                    '</div>' +
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.age + '</p>' +
                    '</div>' +
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.enumNames.race + '</p>' +
                    '</div>' +
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.enumNames.religion + '</p>' +
                    '</div>' +
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.enumNames.cast + '</p>' +
                    '</div>' +
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.enumNames.city + '</p>' +
                    '</div>' +
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.enumNames.country + '</p>' +
                    '</div>' +
                    '<div class="px-1 pb-2">' +
                    '<p class="small text-muted mb-1">Gender</p>' +
                    '<p class="small mb-0 w-100">' + value.createdTimeAgo + '</p>' +
                    '</div>' +

                    '<div class="col-4 col-xs-12 d-flex pt-1">'+
                    '<a href="#" data-mdb-button-init data-mdb-ripple-init class="btn btn-sm btn-outline-primary me-1 flex-grow-1">Details</a>'+
                    '<a href="#" data-mdb-button-init data-mdb-ripple-init class="btn btn-sm btn-primary flex-grow-1">Connect</a>'+                 
                    '</div>' +

                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</section>';
                    data = data+dataRow;

            });

            $('#filter-list').append(data);
            page(response);
        }

        function page(response) {
            var pageNos = '';
            for (var i = 1; i <= response.data.totalPages; i++) {
                if (i == response.data.currentPage) {
                    pageNos = pageNos +
                        '<li class="page-item active">' +
                        '<a class="page-link" href="#">' + i + '</a>' +
                        '</li>';
                } else {
                    pageNos = pageNos +
                        '<li class="page-item">' +
                        '<a class="page-link" href="#">' + i + '</a>' +
                        '</li>';
                }
            }

            var data = '';
            data =
                '<nav aria-label="Page navigation example">' +
                '<ul class="pagination justify-content-center">' +
                '<li class="page-item">' +
                '<a class="page-link" href="#">' +
                '<span aria-hidden="true">&laquo;</span>' +
                '</a>' +
                '</li>' +

                (response.data.currentPage > 1 ?
                    '<li class="page-item">' +
                    '<a class="page-link" href="">' +
                    '<span aria-hidden="true">&lsaquo;</span>' +
                    '</a>' +
                    '</li>' : ''
                ) +

                (pageNos) +                                       
          
                (response.data.currentPage > response.data.totalPages ?
                    '<li class="page-item">' +
                    '<a class="page-link" href="">' +
                    '<span aria-hidden="true">&rsaquo;</span>' +
                    '</a>' +
                    '</li>' : ''
                ) +


                '<li class="page-item">' +
                '<a class="page-link" href="#">' +
                '<span aria-hidden="true">&raquo;</span>' +
                '</a>' +
                '</li>' +
                '</ul>' +
                '</nav>';

            $('#paginage').append(data);
        }

       
    </script>
}


 