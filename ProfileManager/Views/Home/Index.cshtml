@using ProfileManager.ViewModels;
@using ProfileManager.Common.Helpers;
@using ProfileManager.Common.Paginate;
@using Newtonsoft.Json;

@{
    ViewData["Title"] = "Home Page";
}

@* @model Paginate<ProfileViewModel> *@
@model FilterViewModel

@inject IConfiguration Configuration
@{
    var pageSize = Configuration["Pagnation:PageSize"];
}

<section class="h-100 gradient-custom-2">
    <div class="container h-100">
        <div class="row d-flex justify-content-center">

            <div class="col col-lg-3 col-xl-4">
                <section class="my-2" style="p-2 border-radius: .5rem .5rem 0 0;">
                    <div class="row d-flex justify-content-center">
                        <div class="col-12 col-md-12">
                            <div class="card" style="border-radius: 15px;">
                                <div class="card-body p-3">
                                  <h3>Filter</h3>
                                  <hr />


@*                                   <div class="form-group mt-3">
                                    <label asp-for="Gender" class="control-label col-md-2 mb-1"></label>
                                    <div class="col-md-10 mb-3">
                                        <div class="form-check form-check-inline">
                                            <input asp-for="Gender" class="form-check-input" type="radio" id="inlineRadio1" value="Male">
                                            <label class="form-check-label" for="inlineRadio1">Male</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input asp-for="Gender" class="form-check-input" type="radio" id="inlineRadio2" value="Female">
                                            <label class="form-check-label" for="inlineRadio2">Female</label>
                                        </div>
                                        <span asp-validation-for="Gender" class="text-danger"></span>
                                    </div>
                                </div>*@

                                    <div class="mb-3">
                                        <label for="exampleFormControlInput1" class="form-label">Gender </label>
                                        
                                            <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                                            <input asp-for="Gender" class="btn-check" type="radio" name="btnGender" id="btnradio1" autocomplete="off" value="1">
                                                @* <input type="radio" class="btn-check" name="btnGender" id="btnradio1" autocomplete="off" value="1"> *@
                                                <label class="btn btn-outline-primary" for="btnradio1">Male</label>

                                            <input asp-for="Gender" class="btn-check" type="radio" name="btnGender" id="btnradio3" autocomplete="off" value="2">
                                                @* <input type="radio" class="btn-check" name="btnGender" id="btnradio3" autocomplete="off" value="2"> *@
                                                <label class="btn btn-outline-primary" for="btnradio3">Female</label>
                                            </div>
                                                                   
                                    </div>

                                    <div class="form-group mt-3">
                                        <label asp-for="District" class="control-label col-md-2 mb-1"></label>
                                        <div class="col-md-10">
                                            <select id="drpDistrict" class="form-control" asp-for="District" asp-items="Html.GetEnumSelectList<ProfileManager.Common.Enums.DistrictEnum>()">
                                                <option selected="selected" value="">Please select</option>
                                            </select>
                                            <span asp-validation-for="District" class="text-danger"></span>
                                        </div>
                                    </div>
         
                                    <div class="form-group row">
                                        <label class="control-label mb-1" for="exampleFormControlSelect1">Age Between</label>
                                        <div class="form-group col-4">
                                            @* <label for="exampleFormControlSelect1">Example select</label> *@
                                            <select class="form-control" id="selAgeFrom">                  
                                                <option value="0">0</option>
                                                <option value="20">20</option>
                                                <option value="21">21</option>
                                                <option value="22">22</option>
                                                <option value="23">23</option>
                                                <option value="24">24</option>
                                                <option value="25">25</option>
                                                <option value="26">26</option>
                                                <option value="27">27</option>
                                                <option value="28">28</option>
                                                <option value="29">29</option>
                                                <option value="30">30</option>
                                                <option value="31">31</option>
                                                <option value="32">32</option>
                                                <option value="33">33</option>
                                                <option value="34">34</option>
                                                <option value="35">35</option>
                                                <option value="36">36</option>
                                                <option value="37">37</option>
                                                <option value="38">38</option>
                                                <option value="39">39</option>
                                                <option value="40">40</option>
                                                <option value="41">41</option>
                                                <option value="42">42</option>
                                                <option value="43">43</option>
                                                <option value="44">44</option>
                                                <option value="45">45</option>
                                                <option value="46">46</option>
                                                <option value="47">47</option>
                                                <option value="48">48</option>
                                                <option value="49">49</option>
                                                <option value="50">50</option>
                                                <option value="50">50</option>
                                                <option value="51">51</option>
                                                <option value="52">52</option>
                                                <option value="53">53</option>
                                                <option value="54">54</option>
                                                <option value="55">55</option>
                                                <option value="56">56</option>
                                                <option value="57">57</option>
                                                <option value="58">58</option>
                                                <option value="59">59</option>
                                                <option value="60">60</option>
                                                <option value="61">61</option>
                                                <option value="62">62</option>
                                                <option value="63">63</option>
                                                <option value="64">64</option>
                                                <option value="65">65</option>
                                                <option value="66">66</option>
                                                <option value="67">67</option>
                                                <option value="68">68</option>
                                                <option value="69">69</option>
                                                <option value="70">70</option>
                                                <option value="71">71</option>
                                                <option value="72">72</option>
                                                <option value="73">73</option>
                                                <option value="74">74</option>
                                                <option value="75">75</option>                                               
                                            </select>                            
                                        </div>

                                        <div class="form-group col-4">
                                            @* <label for="exampleFormControlSelect1">Example select</label> *@
                                            <select class="form-control" id="selAgeTo">
                                                <option value="0">0</option>
                                                <option value="20">20</option>
                                                <option value="21">21</option>
                                                <option value="22">22</option>
                                                <option value="23">23</option>
                                                <option value="24">24</option>
                                                <option value="25">25</option>
                                                <option value="26">26</option>
                                                <option value="27">27</option>
                                                <option value="28">28</option>
                                                <option value="29">29</option>
                                                <option value="30">30</option>
                                                <option value="31">31</option>
                                                <option value="32">32</option>
                                                <option value="33">33</option>
                                                <option value="34">34</option>
                                                <option value="35">35</option>
                                                <option value="36">36</option>
                                                <option value="37">37</option>
                                                <option value="38">38</option>
                                                <option value="39">39</option>
                                                <option value="40">40</option>
                                                <option value="41">41</option>
                                                <option value="42">42</option>
                                                <option value="43">43</option>
                                                <option value="44">44</option>
                                                <option value="45">45</option>
                                                <option value="46">46</option>
                                                <option value="47">47</option>
                                                <option value="48">48</option>
                                                <option value="49">49</option>
                                                <option value="50">50</option>
                                                <option value="50">50</option>
                                                <option value="51">51</option>
                                                <option value="52">52</option>
                                                <option value="53">53</option>
                                                <option value="54">54</option>
                                                <option value="55">55</option>
                                                <option value="56">56</option>
                                                <option value="57">57</option>
                                                <option value="58">58</option>
                                                <option value="59">59</option>
                                                <option value="60">60</option>
                                                <option value="61">61</option>
                                                <option value="62">62</option>
                                                <option value="63">63</option>
                                                <option value="64">64</option>
                                                <option value="65">65</option>
                                                <option value="66">66</option>
                                                <option value="67">67</option>
                                                <option value="68">68</option>
                                                <option value="69">69</option>
                                                <option value="70">70</option>
                                                <option value="71">71</option>
                                                <option value="72">72</option>
                                                <option value="73">73</option>
                                                <option value="74">74</option>
                                                <option value="75">75</option>
                                            </select>                                           
                                         </div>
                                    </div>

                                   <div class="form-group mt-3">
                                        <label asp-for="CivilStatus" class="control-label col-md-12 mb-1"></label>
                                        <div class="col-md-10">
                                            <select id="selCivilStatus" class="form-control" asp-for="CivilStatus" asp-items="Html.GetEnumSelectList<ProfileManager.Common.Enums.CivilStatusEnum>()">
                                                <option selected="selected" value="">Please select</option>
                                            </select>
                                            <span asp-validation-for="CivilStatus" class="text-danger"></span>
                                        </div>
                                    </div>

                                    <div class="form-group mt-3">
                                        <label asp-for="Job" class="control-label col-md-12 mb-1"></label>
                                        <div class="col-md-10">
                                            <select id="selJob" class="form-control" asp-for="Job" asp-items="Html.GetEnumSelectList<ProfileManager.Common.Enums.JobEnum>()">
                                                <option selected="selected" value="">Please select</option>
                                            </select>
                                            <span asp-validation-for="Job" class="text-danger"></span>
                                        </div>
                                    </div>

                                    <div class="form-group mt-3">
                                        <label asp-for="Cast" class="control-label col-md-12 mb-1"></label>
                                        <div class="col-md-10">
                                            <select id="selCast" class="form-control" asp-for="Cast" asp-items="Html.GetEnumSelectList<ProfileManager.Common.Enums.CastEnum>()">
                                                <option selected="selected" value="">Please select</option>
                                            </select>
                                            <span asp-validation-for="Cast" class="text-danger"></span>
                                        </div>
                                    </div>
                                    <div class="form-group mt-3">
                                        <label asp-for="Race" class="control-label col-md-12 mb-1"></label>
                                        <div class="col-md-10">
                                            <select id="selRace" class="form-control" asp-for="Race" asp-items="Html.GetEnumSelectList<ProfileManager.Common.Enums.RaceEnum>()">
                                                <option selected="selected" value="">Please select</option>
                                            </select>
                                            <span asp-validation-for="Race" class="text-danger"></span>
                                        </div>
                                    </div>
                                    <div class="form-group mt-3">
                                        <label asp-for="Religion" class="control-label col-md-12 mb-1"></label>
                                        <div class="col-md-10">
                                            <select id="selReligion" class="form-control" asp-for="Religion" asp-items="Html.GetEnumSelectList<ProfileManager.Common.Enums.ReligionEnum>()">
                                                <option selected="selected" value="">Please select</option>
                                            </select>
                                            <span asp-validation-for="Religion" class="text-danger"></span>
                                        </div>
                                    </div>

                                    <div class="form-group mt-3">
                                        <label asp-for="MemberId" class="control-label col-md-12 mb-1"></label>
                                        <div class="col-md-10">                                           
                                            <input id="txtMemberId" class="form-control" asp-for="MemberId" type="text" />
                                            <span asp-validation-for="MemberId" class="text-danger"></span>
                                        </div>
                                    </div>


                                    @* <div class="mb-3">
                                        <label for="exampleFormControlInput1" class="form-label">District</label>
                                     
                                            <select class="form-select" aria-label="Select District">
                                                <option selected>Open this select menu</option>
                                                <option value="1">One</option>
                                                <option value="2">Two</option>
                                                <option value="3">Three</option>
                                            </select>                   
                                    </div> *@



                                    <div class="mb-3 mt-4">
                                        <button id="btnFilter" class="btn btn-sm btn-primary w-50">Filter</button>
                                        <a asp-controller="Home" asp-action="Index" id="btnFilterClear" class="btn btn-sm btn-outline-primary w-25">Clear</a>

                                    </div>                              
       
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <div class="col col-lg-9 col-xl-8">
                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <div id="filter-list"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</section>

<div id="paginage"></div>



@section Scripts{
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="~/js/ProfileList.js" asp-append-version="true"></script>   

    <script>
             function getFilters(isFilter = false, pageNo = 1) {
                var gender = @Html.Raw(Json.Serialize(@Model.Gender));
                var district = @Html.Raw(Json.Serialize(@Model.District));
                var ageFrom = @Html.Raw(Json.Serialize(@Model.AgeFrom));
                var ageTo = @Html.Raw(Json.Serialize(@Model.AgeTo));
                var civilStatus = @Html.Raw(Json.Serialize(@Model.CivilStatus));

                var job = @Html.Raw(Json.Serialize(@Model.Job));

                var cast = @Html.Raw(Json.Serialize(@Model.Cast));
                var race = @Html.Raw(Json.Serialize(@Model.Race));
                var religion = @Html.Raw(Json.Serialize(@Model.Religion));

                var memberId = @Html.Raw(Json.Serialize(@Model.MemberId));


                if (isFilter){
                    gender = $('input[name="btnGender"]:checked').val();
                    district = $('#drpDistrict option:selected').val();
                    ageFrom = $('#selAgeFrom option:selected').val();
                    ageTo = $('#selAgeTo option:selected').val();
                    civilStatus = $('#selCivilStatus option:selected').val();

                    job = $('#selJob option:selected').val();

                    cast = $('#selCast option:selected').val();
                    race = $('#selRace option:selected').val();
                    religion = $('#selReligion option:selected').val();

                    memberId = $('#txtMemberId').text();

                }


                //bind data for elements
                $("input[name=btnGender][value='" + gender + "']").prop("checked", true);
                $("#drpDistrict option[value='" + district + "']").prop('selected', true);
                $("#selAgeFrom option[value='" + ageFrom + "']").prop('selected', true);
                $("#selAgeTo option[value='" + ageTo + "']").prop('selected', true);
                $("#selCivilStatus option[value='" + civilStatus + "']").prop('selected', true);

                $("#selJob option[value='" + job + "']").prop('selected', true);

                $("#selCast option[value='" + cast + "']").prop('selected', true);
                $("#selRace option[value='" + race + "']").prop('selected', true);
                $("#selReligion option[value='" + religion + "']").prop('selected', true);

                $("#txtMemberId").text(memberId);


                var genderCon = Number(gender ?? 4);
                var districtCon = Number(district ?? 0);
                var ageFromCon = Number(ageFrom ?? 0);
                var ageToCon = Number(ageTo ?? 0);
                var civilStatusCon = Number(civilStatus ?? 0);

                var jobCon = Number(job ?? 0);

                var castCon = Number(cast ?? 0);
                var raceCon = Number(race ?? 0);
                var religionCon = Number(religion ?? 0);

                var memberIdCon = memberId;


                var filter = {
                    page: {
                        pagenumber: pageNo, pagesize: 2
                    }
                }

                if(filter != null){
                    filter["gender"] = genderCon;
                }
                if (districtCon > 0) {
                    filter["district"] = districtCon;
                }
                if (ageFromCon > 0) {
                    filter["ageFrom"] = ageFromCon;
                }
                if (ageToCon > 0) {
                    filter["ageTo"] = ageToCon;
                }
                    if (civilStatusCon > 0) {
                    filter["civilStatus"] = civilStatusCon;
                }

                if (jobCon > 0) {
                    filter["job"] = jobCon;
                }

                if (castCon > 0) {
                    filter["cast"] = castCon;
                }
                if (raceCon > 0) {
                    filter["race"] = raceCon;
                }
                if (religionCon > 0) {
                    filter["religion"] = religionCon;
                }

                if (memberIdCon != null) {
                    filter["memberId"] = memberIdCon;
                }

                return filter;            
            }


          $(document).ready(function () {
            $(window).on('load', function () {

                var page = @Html.Raw(Json.Serialize(@Model.Page.PageNumber));
                var filter = getFilters(false, page);
                filterData(filter);
                settingUpUrl(filter);

                $("#btnFilter").click(function () {

                    var filter = getFilters(true);
                    filterData(filter);
                    settingUpUrl(filter);

                });
            });
           
        });

    </script>
}


 